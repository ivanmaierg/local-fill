{"version":3,"file":"background.js","sources":["../src/background.ts"],"sourcesContent":["// Background service worker for Local-Fill extension\n// Handles rule resolution, profile management, and messaging\n\nconsole.log('Local-Fill: Background service worker loaded');\n\n// Handle extension installation\nchrome.runtime.onInstalled.addListener((details) => {\n  console.log('Local-Fill: Extension installed/updated', details);\n  \n  // Initialize default settings\n  chrome.storage.local.set({\n    settings: {\n      aiAssist: false,\n      hotkey: 'Alt+A',\n      allowlist: [\n        'boards.greenhouse.io',\n        'jobs.lever.co',\n        '*.myworkdayjobs.com',\n        '*.ashbyhq.com'\n      ]\n    }\n  });\n});\n\n// Handle keyboard commands\nchrome.commands.onCommand.addListener((command) => {\n  console.log('Local-Fill: Command received', command);\n  \n  if (command === 'trigger-autofill') {\n    // Send message to active tab to trigger autofill\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n      if (tabs[0]?.id) {\n        chrome.tabs.sendMessage(tabs[0].id, { type: 'TRIGGER_AUTOFILL' });\n      }\n    });\n  }\n});\n\n// Handle messages from content scripts\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n  console.log('Local-Fill: Message received', message);\n  \n  switch (message.type) {\n    case 'GET_ACTIVE_PROFILE':\n      handleGetActiveProfile(sendResponse);\n      return true; // Keep message channel open for async response\n      \n    case 'GET_RULES':\n      handleGetRules(message.domain, sendResponse);\n      return true;\n      \n    case 'SAVE_RULE':\n      handleSaveRule(message.rule, sendResponse);\n      return true;\n      \n    default:\n      console.warn('Local-Fill: Unknown message type', message.type);\n      sendResponse({ error: 'Unknown message type' });\n  }\n});\n\nasync function handleGetActiveProfile(sendResponse: (response: any) => void) {\n  try {\n    const result = await chrome.storage.local.get(['activeProfile', 'profiles']);\n    const activeProfile = result.activeProfile || null;\n    const profiles = result.profiles || [];\n    \n    sendResponse({ success: true, data: { activeProfile, profiles } });\n  } catch (error) {\n    console.error('Local-Fill: Error getting active profile', error);\n    sendResponse({ success: false, error: error.message });\n  }\n}\n\nasync function handleGetRules(domain: string, sendResponse: (response: any) => void) {\n  try {\n    const result = await chrome.storage.local.get(['rules']);\n    const rules = result.rules || {};\n    const domainRules = rules[domain] || [];\n    \n    sendResponse({ success: true, data: domainRules });\n  } catch (error) {\n    console.error('Local-Fill: Error getting rules', error);\n    sendResponse({ success: false, error: error.message });\n  }\n}\n\nasync function handleSaveRule(rule: any, sendResponse: (response: any) => void) {\n  try {\n    const result = await chrome.storage.local.get(['rules']);\n    const rules = result.rules || {};\n    \n    if (!rules[rule.domain]) {\n      rules[rule.domain] = [];\n    }\n    \n    rules[rule.domain].push(rule);\n    await chrome.storage.local.set({ rules });\n    \n    sendResponse({ success: true });\n  } catch (error) {\n    console.error('Local-Fill: Error saving rule', error);\n    sendResponse({ success: false, error: error.message });\n  }\n}\n"],"names":[],"mappings":"AAGA,QAAQ,IAAI,8CAA8C;AAG1D,OAAO,QAAQ,YAAY,YAAY,CAAC,YAAY;AAClD,UAAQ,IAAI,2CAA2C,OAAO;AAG9D,SAAO,QAAQ,MAAM,IAAI;AAAA,IACvB,UAAU;AAAA,MACR,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,WAAW;AAAA,QACT;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MAAA;AAAA,IACF;AAAA,EACF,CACD;AACH,CAAC;AAGD,OAAO,SAAS,UAAU,YAAY,CAAC,YAAY;AACjD,UAAQ,IAAI,gCAAgC,OAAO;AAEnD,MAAI,YAAY,oBAAoB;AAElC,WAAO,KAAK,MAAM,EAAE,QAAQ,MAAM,eAAe,QAAQ,CAAC,SAAS;AACjE,UAAI,KAAK,CAAC,GAAG,IAAI;AACf,eAAO,KAAK,YAAY,KAAK,CAAC,EAAE,IAAI,EAAE,MAAM,oBAAoB;AAAA,MAClE;AAAA,IACF,CAAC;AAAA,EACH;AACF,CAAC;AAGD,OAAO,QAAQ,UAAU,YAAY,CAAC,SAAS,QAAQ,iBAAiB;AACtE,UAAQ,IAAI,gCAAgC,OAAO;AAEnD,UAAQ,QAAQ,MAAA;AAAA,IACd,KAAK;AACH,6BAAuB,YAAY;AACnC,aAAO;AAAA,IAET,KAAK;AACH,qBAAe,QAAQ,QAAQ,YAAY;AAC3C,aAAO;AAAA,IAET,KAAK;AACH,qBAAe,QAAQ,MAAM,YAAY;AACzC,aAAO;AAAA,IAET;AACE,cAAQ,KAAK,oCAAoC,QAAQ,IAAI;AAC7D,mBAAa,EAAE,OAAO,wBAAwB;AAAA,EAAA;AAEpD,CAAC;AAED,eAAe,uBAAuB,cAAuC;AAC3E,MAAI;AACF,UAAM,SAAS,MAAM,OAAO,QAAQ,MAAM,IAAI,CAAC,iBAAiB,UAAU,CAAC;AAC3E,UAAM,gBAAgB,OAAO,iBAAiB;AAC9C,UAAM,WAAW,OAAO,YAAY,CAAA;AAEpC,iBAAa,EAAE,SAAS,MAAM,MAAM,EAAE,eAAe,SAAA,GAAY;AAAA,EACnE,SAAS,OAAO;AACd,YAAQ,MAAM,4CAA4C,KAAK;AAC/D,iBAAa,EAAE,SAAS,OAAO,OAAO,MAAM,SAAS;AAAA,EACvD;AACF;AAEA,eAAe,eAAe,QAAgB,cAAuC;AACnF,MAAI;AACF,UAAM,SAAS,MAAM,OAAO,QAAQ,MAAM,IAAI,CAAC,OAAO,CAAC;AACvD,UAAM,QAAQ,OAAO,SAAS,CAAA;AAC9B,UAAM,cAAc,MAAM,MAAM,KAAK,CAAA;AAErC,iBAAa,EAAE,SAAS,MAAM,MAAM,aAAa;AAAA,EACnD,SAAS,OAAO;AACd,YAAQ,MAAM,mCAAmC,KAAK;AACtD,iBAAa,EAAE,SAAS,OAAO,OAAO,MAAM,SAAS;AAAA,EACvD;AACF;AAEA,eAAe,eAAe,MAAW,cAAuC;AAC9E,MAAI;AACF,UAAM,SAAS,MAAM,OAAO,QAAQ,MAAM,IAAI,CAAC,OAAO,CAAC;AACvD,UAAM,QAAQ,OAAO,SAAS,CAAA;AAE9B,QAAI,CAAC,MAAM,KAAK,MAAM,GAAG;AACvB,YAAM,KAAK,MAAM,IAAI,CAAA;AAAA,IACvB;AAEA,UAAM,KAAK,MAAM,EAAE,KAAK,IAAI;AAC5B,UAAM,OAAO,QAAQ,MAAM,IAAI,EAAE,OAAO;AAExC,iBAAa,EAAE,SAAS,MAAM;AAAA,EAChC,SAAS,OAAO;AACd,YAAQ,MAAM,iCAAiC,KAAK;AACpD,iBAAa,EAAE,SAAS,OAAO,OAAO,MAAM,SAAS;AAAA,EACvD;AACF;"}